<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OpenID Connect Deferred Token Response Flow 1.0 - draft 00</title>
<meta content="Frederik Krogsdal Jacobsen" name="author">
<meta content="Guilherme de Oliveira Niero" name="author">
<meta content="
       Draft of the Deferred Token Response Flow. 
    " name="description">
<meta content="xml2rfc 3.20.0" name="generator">
<meta content="security" name="keyword">
<meta content="openid" name="keyword">
<meta content="lifecycle" name="keyword">
<meta content="openid-deferred-token-response-1_0" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.20.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 2.4.0
    intervaltree 3.0.2
    Jinja2 3.1.2
    lxml 5.2.1
    platformdirs 4.5.1
    pycountry 23.12.11
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.1.2
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 61.1
-->
<link href="openid-deferred-token-response-1_0.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">openid-deferred-token-response</td>
<td class="right">February 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Jacobsen &amp; de Oliveira Niero</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OpenID Connect</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-02-03" class="published">3 February 2026</time>
    </dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F.K. Jacobsen</div>
<div class="org">Idura</div>
</div>
<div class="author">
      <div class="author-name">G. de Oliveira Niero</div>
<div class="org">Independent</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OpenID Connect Deferred Token Response Flow 1.0 - draft 00</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Draft of the Deferred Token Response Flow.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-notation-and-c" class="internal xref">Requirements Notation and Conventions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-registration-and-discovery-" class="internal xref">Registration and Discovery Metadata</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-authorization-server-metada" class="internal xref">Authorization Server Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-client-registration-metadat" class="internal xref">Client Registration Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-starting-a-deferred-token-f" class="internal xref">Starting a Deferred Token Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-deferred-code-response-type" class="internal xref">Deferred Code Response Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-authentication-request" class="internal xref">Authentication Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-authentication-request-vali" class="internal xref">Authentication Request Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-openid-provider-obtains-end" class="internal xref">OpenID Provider Obtains End-User Authorization and Identity Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-authentication-request-ackn" class="internal xref">Authentication Request Acknowledgment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-authentication-request-ackno" class="internal xref">Authentication Request Acknowledgment Validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-exchanging-the-deferred-cod" class="internal xref">Exchanging the Deferred Code to obtain Deferred Authentication ID</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-deferred-code-exchange-requ" class="internal xref">Deferred Code Exchange Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-deferred-code-exchange-reque" class="internal xref">Deferred Code Exchange Request Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-successful-deferred-code-ex" class="internal xref">Successful Deferred Code Exchange Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-deferred-code-exchange-resp" class="internal xref">Deferred Code Exchange Response Validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-openid-provider-authenticat" class="internal xref">OpenID Provider Authenticates End-User</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-deferred-client-notificatio" class="internal xref">Deferred Client Notification Endpoint</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-getting-the-authentication-" class="internal xref">Getting the Authentication Result</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-token-request-using-the-aut" class="internal xref">Token Request using the Authentication Request ID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-token-request-validation" class="internal xref">Token Request Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-successful-token-response" class="internal xref">Successful Token Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-ping-callback" class="internal xref">Ping Callback</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-canceling-an-ongoing-authen" class="internal xref">Canceling an Ongoing Authentication Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-authentication-cancellation" class="internal xref">Authentication Cancellation Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-authentication-cancellation-" class="internal xref">Authentication Cancellation Request Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-authentication-cancellation-r" class="internal xref">Authentication Cancellation Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-token-request-error-respons" class="internal xref">Token Request Error Response</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-deferred-code-exchange-erro" class="internal xref">Deferred Code Exchange Error Response</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-authentication-request-erro" class="internal xref">Authentication Request Error Response</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-authentication-cancellation-re" class="internal xref">Authentication Cancellation Request Error Response</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-interim-id-tokens" class="internal xref">Interim ID Tokens</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-multi-valued-response-type-" class="internal xref">Multi-valued Response Type Authentication Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="auto internal xref">14.3</a>.  <a href="#name-design-considerations-for-p" class="internal xref">Design Considerations for Poll and Ping</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-14.4" class="auto internal xref">14.4</a>.  <a href="#name-context-on-the-progress-of-" class="internal xref">Context on the Progress of Incomplete Authentication Processes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#section-16.1" class="auto internal xref">16.1</a>.  <a href="#name-usage-of-deferred-notificat" class="internal xref">Usage of Deferred Notification Tokens</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="auto internal xref">17</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="auto internal xref">18</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#section-18.1" class="auto internal xref">18.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#section-18.2" class="auto internal xref">18.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-use-cases" class="internal xref">Use cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-sample-use-case-1-high-risk" class="internal xref">Sample Use Case 1: High Risk Transaction Evaluation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-sample-use-case-2-step-up-i" class="internal xref">Sample Use Case 2: Step-up identity assurance during a non-registration process</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.3">
                <p id="section-toc.1-1.19.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-sample-use-case-3-identific" class="internal xref">Sample Use Case 3: Identification Based on Physical Evidence</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-notices" class="internal xref">Notices</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">OpenID Connect allows Relying Parties (RP) to authenticate their users for clients that support HTTP redirection mechanisms.
OpenID Connect requires the user to start the authentication flow and the Client to receive verifiable assertions about the identity of the user via redirects through the user agent.
This requires the authentication flow to complete relatively quickly, such that the session is preserved in the user agent.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The OpenID Connect Client-Initiated Backchannel Authentication Flow introduces an asynchronous method for authentication result notification or delivery.
But the Client-Initiated Backchannel Authentication Flow also requires direct communication from the Client to the OpenID Provider without redirects through the user agent.
This means that the Client, not the user, must initiate the flow.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Deferred Token Response (DTR) is a new authentication flow in which the end-user initiates the flow and the Client can receive the authentication result asynchronously.
This allows users to interactively start an authentication flow which may take any amount of time to complete without having to preserve a session in their user agent.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This specification does not change the semantics of the OpenID Connect Authentication flow.
It introduces new asynchronous methods for authentication result delivery and notification.
It does not introduce new scope values nor does it change the semantics of standard OpenID Connect parameters.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="requirements-notation-and-conventions">
<section id="section-1.1">
        <h3 id="name-requirements-notation-and-c">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation-and-c" class="section-name selfRef">Requirements Notation and Conventions</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.
Throughout this document, values are quoted to indicate that they are to be taken literally.
When using these values in protocol messages, the quotes MUST NOT be used as part of the value.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">This specification uses the terms "Access Token", "Authorization Endpoint", "Authorization Request", "Authorization Response", "Authorization Code Grant", "Authorization Server", "Client", "Public Client", "Client Authentication", "Client Identifier", "Token Endpoint", "Token Request" and "Token Response" defined by OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the terms "OpenID Provider (OP)", "Relying Party (RP)", "End-User" and "Request Object" as defined by OpenID Connect Core <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>, the term "JSON Web Token (JWT)" defined by JSON Web Token (JWT) <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>, and the term "DPoP Proof" defined by OAuth 2.0 Demonstrating Proof of Possession (DPoP) <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">This specification also defines the following terms:<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-1.2-3">
          <dt id="section-1.2-3.1">Authentication Process</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.2">The steps taken by an OpenID Provider to authenticate an End-User. The process MAY depend on Identity Information provided by the End-User. For example, the Authentication Process might involve checking the integrity of the Identity Information. The nature of the Authentication Process is beyond the scope of this specification.<a href="#section-1.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.3">Identity Information</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.4">Information collected from the End-User by the OpenID Provider as input to the Authentication Process. For example, this might be a picture of a driver's license and a video of the End-User performing a series of gestures. The nature of the Identity Information is beyond the scope of this specification.<a href="#section-1.2-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-2-1">The Deferred Token Response (DTR) flow enables an OpenID Provider to defer the authentication of an End-User for an arbitrarily long time.
The Deferred Token Response Flow consists of the following steps:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-2-2">
<li id="section-2-2.1">The Relying Party (RP) sends a request to the OpenID Provider (OP).<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-2-2.2">The OP initiates an Authentication Process and collects authorization and Identity Information from the End-User.<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-2-2.3">The OP responds to the RP with a code identifying that Authentication Process.<a href="#section-2-2.3" class="pilcrow">¶</a>
</li>
        <li id="section-2-2.4">The RP exchanges the code for a long-lived Access Token and optionally an interim ID Token at the OP.<a href="#section-2-2.4" class="pilcrow">¶</a>
</li>
        <li id="section-2-2.5">The RP polls the Token Endpoint to eventually receive an ID Token, Access Token, and optionally Refresh Token.<a href="#section-2-2.5" class="pilcrow">¶</a>
</li>
        <li id="section-2-2.6">The OP eventually completes the Authentication Process.<a href="#section-2-2.6" class="pilcrow">¶</a>
</li>
        <li id="section-2-2.7">The OP optionally sends a Ping to the RP when the Authentication Process has completed.<a href="#section-2-2.7" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-2-3">These steps are illustrated in the following diagram:<a href="#section-2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2-4">
<pre>+----+                                +----+                  +------+
|    |                                |    |                  |      |
|    |---(1) AuthN Request-----------&gt;|    |                  |      |
|    |                                |    |                  | End- |
|    |                                |    |&lt;-(2) Start Auth-&gt;| User |
|    |                                |    |                  |      |
|    |&lt;--(3) Auth Code----------------|    |                  |      |
|    |                                |    |                  +------+
|    |---(4a) Initial Token Request--&gt;|    |
|    |                                |    |
|    |&lt;--(4b) Initial Token Response--|    |
|    |                                |    |
|    |                                |    |---------+
|    |                                |    |         |
| RP |---(5a) Poll Request-----------&gt;| OP |         |
|    |                                |    | (6) Complete AuthN process
|    |&lt;--(5b) Poll Response-----------|    |         |
|    |                                |    |         |
|    |               ...              |    |&lt;--------+
|    |                                |    |
|    |&lt;--(7) Optional Ping------------|    |
|    |                                |    |
|    |---(5a) Poll Request-----------&gt;|    |
|    |                                |    |
|    |&lt;--(5b) Poll Response ----------|    |
|    |                                |    |
+----+                                +----+
</pre><a href="#section-2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="registration-and-discovery-metadata">
<section id="section-3">
      <h2 id="name-registration-and-discovery-">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-registration-and-discovery-" class="section-name selfRef">Registration and Discovery Metadata</a>
      </h2>
<p id="section-3-1">This specification declares parameters for both Authorization Server and Client. Each following section describes them accordingly.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="authorization-server-metadata">
<section id="section-3.1">
        <h3 id="name-authorization-server-metada">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-authorization-server-metada" class="section-name selfRef">Authorization Server Metadata</a>
        </h3>
<p id="section-3.1-1">OPs capable of handling the Deferred Token Response Flows MUST advertise support for it in its OAuth 2.0 Authorization Server Metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> as follows:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-3.1-2">
          <dt id="section-3.1-2.1"><code>response_types_supported</code></dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.2">A <code>deferred_code</code> response type is introduced by this specification in order to indicate to the OP that a deferred authentication response is acceptable once the user interaction ends.<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.3"><code>grant_types_supported</code></dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.4">This specification introduces the Deferred grant type (an extension grant type as defined by <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>) with the value: <code>urn:openid:params:grant-type:deferred</code><a href="#section-3.1-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="client-registration-metadata">
<section id="section-3.2">
        <h3 id="name-client-registration-metadat">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-client-registration-metadat" class="section-name selfRef">Client Registration Metadata</a>
        </h3>
<p id="section-3.2-1">The following Client Metadata parameter is defined by this specification to be used during Client Registration as defined in <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-3.2-2">
          <dt id="section-3.2-2.1"><code>deferred_client_notification_endpoint</code></dt>
          <dd style="margin-left: 1.5em" id="section-3.2-2.2">REQUIRED if the RP desires to be notified when the Authentication decision has been taken. It MUST be an HTTPS URL.<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="starting-a-deferred-token-flow">
<section id="section-4">
      <h2 id="name-starting-a-deferred-token-f">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-starting-a-deferred-token-f" class="section-name selfRef">Starting a Deferred Token Flow</a>
      </h2>
<p id="section-4-1">This section describes how to start an Authentication Process using the Deferred Token Flow.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="deferred-code-response-type">
<section id="section-4.1">
        <h3 id="name-deferred-code-response-type">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-deferred-code-response-type" class="section-name selfRef">Deferred Code Response Type</a>
        </h3>
<p id="section-4.1-1">This section registers a new Response Type, the <code>deferred_code</code>, in accordance with the stipulations in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-8.4" class="relref">Section 8.4</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.
It also defines combinations of the <code>deferred_code</code> Response Type with other Response Types.
The intended purpose of the <code>deferred_code</code> is that the response MUST contain a Deferred Authorization Code which can be used at the Token Endpoint.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.1-2">
          <dt id="section-4.1-2.1"><code>deferred_code</code></dt>
          <dd style="margin-left: 1.5em" id="section-4.1-2.2">When supplied as the <code>response_type</code> parameter in an OAuth 2.0 Authorization Request, a successful response MUST include the parameter <code>deferred_code</code>. The Authorization Server SHOULD NOT return an OAuth 2.0 Authorization Code, Access Token, or Access Token Type in a successful response to the grant request. If a <code>redirect_uri</code> is supplied, the User Agent SHOULD be redirected there after granting or denying access. The request MAY include a <code>state</code> parameter, and if so, the Authorization Server MUST echo its value as a response parameter when issuing either a successful response or an error response.<a href="#section-4.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-2.3"><code>deferred_code code</code></dt>
          <dd style="margin-left: 1.5em" id="section-4.1-2.4">When supplied as the <code>response_type</code> parameter in an OAuth 2.0 Authorization Request, a successful response MUST include either the parameter <code>deferred_code</code> or the parameter <code>code</code>. The Authorization Server SHOULD NOT return an OAuth 2.0 Access Token, or Access Token Type in a successful response to the grant request. If a <code>redirect_uri</code> is supplied, the User Agent SHOULD be redirected there after granting or denying access. The request MAY include a <code>state</code> parameter, and if so, the Authorization Server MUST echo its value as a response parameter when issuing either a successful response or an error response.<a href="#section-4.1-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="authentication-request">
<section id="section-4.2">
        <h3 id="name-authentication-request">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-authentication-request" class="section-name selfRef">Authentication Request</a>
        </h3>
<p id="section-4.2-1">Deferred Token Response introduces a new Authentication Request using the OAuth 2.0 Authorization Request.
This request is the same as the Authentication request of the Authorization Code Flow introduced in Section 3.1.2.1 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span> with the exception of the following parameter:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.2-2">
          <dt id="section-4.2-2.1"><code>response_type</code></dt>
          <dd style="margin-left: 1.5em" id="section-4.2-2.2">REQUIRED. Deferred Token Response value that determines the authorization processing flow to be used, including what parameters are returned from the endpoints used. This value MUST be either <code>deferred_code</code> or <code>deferred_code code</code>.<a href="#section-4.2-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-3">Relying Parties MAY present additional parameters in this request regarding to OAuth 2.0 extensions (such as Rich Authorization Requests).
Authorization Servers MUST accept those parameters and process them accordingly.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">The following is a non-normative example request that would be sent by the User Agent to the Authorization Server in response to a corresponding HTTP 302 redirect response by the Client (with line wraps within values for display purposes only):<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-5">
<pre>GET /authorize?
  response_type=deferred_code
  &amp;client_id=s6BhdRkqt3
  &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
  &amp;scope=openid%20profile%20email
  &amp;nonce=n-0S6_WzA2Mj
  &amp;state=af0ifjsldkj HTTP/1.1
Host: server.example.com
</pre><a href="#section-4.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authentication-request-validation">
<section id="section-4.3">
        <h3 id="name-authentication-request-vali">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-authentication-request-vali" class="section-name selfRef">Authentication Request Validation</a>
        </h3>
<p id="section-4.3-1">The OpenID Provider MUST validate the request received as follows:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.3-2">
<li id="section-4.3-2.1">Verify that the <code>response_type</code> parameter is present and has a value of either <code>deferred_code</code> or <code>deferred_code code</code>.<a href="#section-4.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.2">Check if the Client is registered to use the Deferred Token Response flow.<a href="#section-4.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.3">Validate the remaining Authentication Request parameters in accordance with Section 3.1.2.2 - Authentication Request Validation of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-4.3-2.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.3-3">Additional Authorization Request parameters regarding to OAuth 2.0 extensions MAY be used. In such cases, they MUST be validated according to their definitions.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">If the OpenID Provider encounters any error, it MUST return an error response, per <a href="#authentication-request-error-response" class="auto internal xref">Section 12</a>.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="op-obtains-end-user-authorization-and-identity-information">
<section id="section-4.4">
        <h3 id="name-openid-provider-obtains-end">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-openid-provider-obtains-end" class="section-name selfRef">OpenID Provider Obtains End-User Authorization and Identity Information</a>
        </h3>
<p id="section-4.4-1">Upon receiving a valid Authentication Request, the OpenID Provider (OP) determines whether End-User interaction is required to complete the authentication process. It MAY present OP-controlled interfaces through the User Agent to provide guidance through the Authentication steps.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">Through these interfaces, the OP MAY prompt the End-User to provide credentials, perform multi-factor authentication, or supply additional Identity Information (such as biometric data, government-issued documents, or other forms of verification).<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">The nature and extent of the Identity Information collected are determined by the OP's policies and the authentication requirements of the Relying Party (RP).<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">If no interaction is required, or the End-User successfully completes the required interaction, the OP continues processing the Authentication Request. If the End-User declines or fails to provide sufficient information, the OP MUST return an error response as defined in <a href="#authentication-request-error-response" class="auto internal xref">Section 12</a>.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-request-acknowledgment">
<section id="section-4.5">
        <h3 id="name-authentication-request-ackn">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-authentication-request-ackn" class="section-name selfRef">Authentication Request Acknowledgment</a>
        </h3>
<p id="section-4.5-1">If the Authentication Request is successfully processed in accordance with <a href="#op-obtains-end-user-authorization-and-identity-information" class="auto internal xref">Section 4.4</a>, the OpenID Provider (OP) returns a response to the Relying Party indicating that the request has been accepted and any required user interaction has been completed.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">If the <code>response_type</code> requested by the Relying Party was <code>deferred_code code</code>, the OpenID Provider MAY respond with a Successful Authentication Response as defined in Section 3.1.2.5 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span> to indicate that the user was authenticated immediately.
The remainder of the Authentication then proceeds as an Authorization Code Flow as defined in Section 3.1 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">Otherwise, the response MUST be an Authentication Request Acknowledgment.
Note that an Authentication Request Acknowledgment does not constitute a final Authentication Response, but rather serves as an indication that further processing is underway.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">An Authentication Request Acknowledgment is composed of the following parameters:<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.5-5">
          <dt id="section-4.5-5.1"><code>deferred_code</code></dt>
          <dd style="margin-left: 1.5em" id="section-4.5-5.2">REQUIRED. This is a unique identifier for the Authentication Request made by the Client. It MUST contain sufficient entropy (a minimum of 128 bits while 160 bits is RECOMMENDED) to make brute force guessing or forgery of a valid <code>deferred_code</code> computationally infeasible. The means of achieving this are implementation-specific, with possible approaches including secure pseudorandom number generation or cryptographically secured self-contained tokens. The OpenID Provider MUST restrict the characters used to 'A'-'Z', 'a'-'z', '0'-'9', '.', '-' and '_', to reduce the chance of the client incorrectly decoding or re-encoding the <code>deferred_code</code>; this character set was chosen to allow the server to use unpadded base64url if it wishes. The identifier MUST be treated as opaque by the client.<a href="#section-4.5-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.5-5.3"><code>state</code></dt>
          <dd style="margin-left: 1.5em" id="section-4.5-5.4">OAuth 2.0 state value. REQUIRED if the Authorization Request included the state parameter. Set to the value received from the Client.<a href="#section-4.5-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-6">The following is a non-normative example of an Authentication Request Acknowledgment:<a href="#section-4.5-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-7">
<pre>HTTP/1.1 302 Found
Location: https://client.example.org/cb?
  deferred_code=SplxlOBeZQQYbYS6WxSbIA
  &amp;state=af0ifjsldkj
</pre><a href="#section-4.5-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authentication-request-acknowledgment-validation">
<section id="section-4.6">
        <h3 id="name-authentication-request-ackno">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-authentication-request-ackno" class="section-name selfRef">Authentication Request Acknowledgment Validation</a>
        </h3>
<p id="section-4.6-1">Upon receiving an Authentication Request Acknowledgment, the Relying Party (RP) MUST validate the response as follows:<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.6-2">
<li id="section-4.6-2.1">Ensure that the <code>deferred_code</code> parameter is present.<a href="#section-4.6-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.6-2.2">Verify that a <code>code</code> parameter is not present.<a href="#section-4.6-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.6-2.3">If the Client includes a <code>state</code> parameter in Authentication Requests, verify that the <code>state</code> parameter is present in the response. The Client MAY perform additional validation to match the <code>state</code> parameter response with the one present in the Authentication Request.<a href="#section-4.6-2.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.6-3">When the Client requests the <code>deferred_code code</code> response type, it MUST distinguish if the response being validated is an <a href="#authentication-request-acknowledgment">Authentication Request Acknowledgment</a> or a Successful Authentication Response of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>. This can be achieved by checking for the presence of the <code>deferred_code</code> parameter. Determining the type of response is crucial for the Client to proceed with the appropriate flow.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">Responses containing both <code>code</code> and <code>deferred_code</code> parameters MUST be considered invalid.<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<p id="section-4.6-5">Any unrecognized parameter MUST be ignored by the Client.<a href="#section-4.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="exchanging-the-deferred-code-to-obtain-deferred-authentication-id">
<section id="section-5">
      <h2 id="name-exchanging-the-deferred-cod">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-exchanging-the-deferred-cod" class="section-name selfRef">Exchanging the Deferred Code to obtain Deferred Authentication ID</a>
      </h2>
<p id="section-5-1">The Relying Party (RP) sends a Request to the Token Endpoint, as specified in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, to exchange the <code>deferred_code</code>. Upon successful processing of this request, the OpenID Provider (OP) assigns a Deferred Authentication ID to each Authentication Process. This identifier enables the RP to poll for the result of the corresponding process, in a manner analogous to the <code>auth_req_id</code> defined in <span>[<a href="#OpenID.CIBA" class="cite xref">OpenID.CIBA</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The <code>deferred_code</code> value is not utilized for polling. This allows the OP to apply the same security considerations to the <code>deferred_code</code> as are applied to authorization codes, as described in <span><a href="https://rfc-editor.org/rfc/rfc6819#section-4.4.1" class="relref">Section 4.4.1</a> of [<a href="#RFC6819" class="cite xref">RFC6819</a>]</span> and <span>[<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Interactions involving Public Clients SHOULD be secured using Demonstration of Proof-of-Possession (DPoP) <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>. In such cases, the public key used for the DPoP proof presented in the Deferred Code Exchange Request MUST be the same for the Token Request.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="deferred-code-exchange-request">
<section id="section-5.1">
        <h3 id="name-deferred-code-exchange-requ">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-deferred-code-exchange-requ" class="section-name selfRef">Deferred Code Exchange Request</a>
        </h3>
<p id="section-5.1-1">The Deferred Code Exchange Request exchanges the <code>deferred_code</code> obtained in the Authentication Request Acknowledgment.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The Client makes an HTTP POST request to the Token Endpoint by sending the following parameters using the <code>application/x-www-form-urlencoded</code> format:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.1-3">
          <dt id="section-5.1-3.1"><code>grant_type</code></dt>
          <dd style="margin-left: 1.5em" id="section-5.1-3.2">REQUIRED. Value MUST be <code>urn:openid:params:grant-type:deferred</code>.<a href="#section-5.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-3.3"><code>deferred_code</code></dt>
          <dd style="margin-left: 1.5em" id="section-5.1-3.4">REQUIRED. The identifier of the Authentication Request, issued by the OP to the Client requesting the exchange.<a href="#section-5.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-3.5"><code>deferred_notification_token</code></dt>
          <dd style="margin-left: 1.5em" id="section-5.1-3.6">OPTIONAL. A bearer access token which the OP can use to access the Client's Deferred Notification Endpoint when sending a Ping Callback for this request.<a href="#section-5.1-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-4">Supported extension parameters from the OAuth 2.0 Token Request MAY be included in this request.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">A DPoP proof MAY be included in this request. The RP SHOULD ensure that a public key is not reused across different Authentication Processes.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">The following is a non-normative example of a Deferred Code Exchange Request (with line wraps within values for display purposes only):<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-7">
<pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
DPoP: eyJ0eXAiOiJkcG9wK2p3dCIsImFsZyI6IkVTMjU2IiwiandrIjp7Imt0eSI6IkVDIiwieCI6Imw4dEZyaHgtMzR0VjNoUklDUkRZOXpDa0RscEJoRjQyVVFVZldWQVdCRnMiLCJ5IjoiOVZFNGpmX09rX282NHpiVFRsY3VOSmFqSG10NnY5VERWclUwQ2R2R1JEQSIsImNydiI6IlAtMjU2In19.eyJqdGkiOiJBeDBwYjcyazRtZCIsImh0bSI6IlBPU1QiLCJodHUiOiJodHRwczovL3NlcnZlci5leGFtcGxlLmNvbS90b2tlbiIsImlhdCI6MTc2MzcyMzExMn0.uy3IfO-j8Yg4Aux0uGAuh7_m24WDCfWCUacRPWtFHS9J-HWASoiEqBsuxI1LN3V4To4Mn1ZRv0AVBxuOA6km3g
grant_type=urn:openid:params:grant-type:deferred&amp;deferred_code=SplxlOBeZQQYbYS6WxSbIA&amp;deferred_notification_token=8d67dc78-7faa-4d41-aabd-67707b374255
</pre><a href="#section-5.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="deferred-code-exchange-request-validation">
<section id="section-5.2">
        <h3 id="name-deferred-code-exchange-reque">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-deferred-code-exchange-reque" class="section-name selfRef">Deferred Code Exchange Request Validation</a>
        </h3>
<p id="section-5.2-1">The OP MUST validate the request received as follows:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-5.2-2">
<li id="section-5.2-2.1">Authenticate the Client in accordance with Section 9 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-5.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.2">Ensure the Deferred Code was issued to the authenticated Client.<a href="#section-5.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.3">Verify that the Deferred Code is valid and has not been previously used.<a href="#section-5.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.4">If a DPoP proof was provided, validate it in accordance with <span><a href="https://rfc-editor.org/rfc/rfc9449#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>.<a href="#section-5.2-2.4" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="successful-deferred-code-exchange-response">
<section id="section-5.3">
        <h3 id="name-successful-deferred-code-ex">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-successful-deferred-code-ex" class="section-name selfRef">Successful Deferred Code Exchange Response</a>
        </h3>
<p id="section-5.3-1">After receiving and validating an authorized Deferred Code Exchange Request from the Client, the OpenID Provider returns an HTTP 200 OK response to the Client containing the following parameters encoded in <code>application/json</code> format:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.3-2">
          <dt id="section-5.3-2.1"><code>deferred_auth_id</code></dt>
          <dd style="margin-left: 1.5em" id="section-5.3-2.2">REQUIRED. The Deferred Authentication ID is a unique identifier for the Authentication Process. The identifier MUST be treated as opaque by the client.<a href="#section-5.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-2.3"><code>expires_in</code></dt>
          <dd style="margin-left: 1.5em" id="section-5.3-2.4">OPTIONAL. A JSON number with a positive integer value indicating the expiration time of the <code>deferred_auth_id</code> in seconds. Some requests may naturally become irrelevant once some amount of time has passed. The OP MAY indicate that this is the case by returning a value in this parameter. The method of determining this value is outside the scope of this specification. Clients SHOULD support arbitrarily large values for this parameter.<a href="#section-5.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-2.5"><code>interval</code></dt>
          <dd style="margin-left: 1.5em" id="section-5.3-2.6">OPTIONAL. A JSON number with a positive integer value indicating the minimum amount of time in seconds that the Client MUST wait between polling requests to the token endpoint. Clients SHOULD support arbitrarily large values for this parameter.<a href="#section-5.3-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-2.7"><code>interim_id_token</code></dt>
          <dd style="margin-left: 1.5em" id="section-5.3-2.8">OPTIONAL. In some cases, the OP can immediately authenticate parts of the Identity Information provided by the End User. In some cases, the Client is interested in the Identity Information provided by the End User even before it is validated by the OP. To support this, the OP MAY include an Interim ID Token containing partially verified claims. The method by which the OP indicates the validation status of each claim is outside the scope of this specification.<a href="#section-5.3-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.3-3">Once redeemed for a successful Deferred Code Exchange Response, the <code>deferred_code</code> value that was used is no longer valid.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">The OP MUST bind the public key used in DPoP proofs to <code>deferred_auth_id</code> when the Client is of type Public Client and a DPoP proof is presented in the Deferred Code Exchange Request. Further interactions involving a <code>deferred_auth_id</code> MUST require a DPoP proof utilizing the same public key. This mechanism is similar to the binding of DPoP proofs to Refresh Tokens as described in <span><a href="https://rfc-editor.org/rfc/rfc9449#section-5" class="relref">Section 5</a> of [<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3-5">Clients MUST ignore unrecognized response parameters.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3-6">If the Client sent a <code>deferred_notification_token</code> in the Deferred Code Exchange Request, the Client SHOULD bind the received <code>deferred_auth_id</code> to the <code>deferred_notification_token</code> to prevent mix-up attacks.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3-7">The following is a non-normative example of a successful Deferred Code Exchange Response:<a href="#section-5.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-8">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "deferred_auth_id": "f4oirNBUlM",
  "expires_in": 10800
  "interval": 60,
  "interim_id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjI3MTdmMzAzYTI3NjVlOGFjYmY0MTEwMGFhOGE0NjllIiwidHlwIjoiSldUIn0.eyJpc3MiOiJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwic3ViIjoiMjQ4Mjg5NzYxMDAxIiwiZW1haWwiOiJqb2huZG9lQGV4YW1wbGUuY29tIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhdWQiOiJzNkJoZFJrcXQzIiwibm9uY2UiOiJuLTBTNl9XekEyTWoiLCJleHAiOjE3NjIxOTE2ODgsImlhdCI6MTc2MjE5MTk4OH0.TmW5LZmr5tM_gDbk6Tc7VAMw6zYv9eo1BqbKf19rhw8cHsPLLMA25YilywdA66KO2ESWvY3S5YJn3Azypri5jQOeQTmPQZAeXHjcVSBeABzAQz3eGIdtAaDLQ5p0DafdxgEDOrcLLK8yk3X16aBGpJegdBY1HfqAhuYPV2D_LUCeGbJxn0-4nLF9_U7Ws3c4o_3nq9ZNTVEAoJJckRYhXM6pPf2-1tZvRZD2P9B0vPSiJwqN2JFOBoDROwhxPJU4MKWQ3mp5pdGTZqlUL7wn0a2dG-EI1eq6oQrGwINqTHiqZbttCuz1wQtezRxHYITEAoVaI2c3zad0ZSzTbAGNkw"
}
</pre><a href="#section-5.3-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="deferred-code-exchange-response-validation">
<section id="section-5.4">
        <h3 id="name-deferred-code-exchange-resp">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-deferred-code-exchange-resp" class="section-name selfRef">Deferred Code Exchange Response Validation</a>
        </h3>
<p id="section-5.4-1">Upon receiving a Successful Deferred Code Exchange Response, the Relying Party (RP) MUST validate the response as follows:<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-5.4-2">
<li id="section-5.4-2.1">Ensure that the <code>deferred_auth_id</code> parameter is present.<a href="#section-5.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-2.2">If an <code>interim_id_token</code> is present, validate it in accordance with Section 3.1.3.7 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-5.4-2.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.4-3">The Client MUST retain the <code>deferred_auth_id</code> to validate Ping callbacks and to use when making Token or Cancellation requests.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">The Client SHOULD store the expiration time in order to clean up authentication requests for which no Ping Callback is received.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="openid-provider-authenticates-end-user">
<section id="section-6">
      <h2 id="name-openid-provider-authenticat">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-openid-provider-authenticat" class="section-name selfRef">OpenID Provider Authenticates End-User</a>
      </h2>
<p id="section-6-1">After issuing the <code>deferred_code</code> in the Authentication Request Acknowledgment, the OP continues the Authentication Process by validating the Identity Information obtained from the End-User. The OP MAY take an arbitrary amount of time to complete this process.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The specific processing performed by the OP during this step is outside the scope of this specification. For example, the OP might perform manual review, contact the End User, or use other methods to authenticate the End-User based on the provided Identity Information.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">While processing the request, the OP MAY allow the RP to cancel the request as described in <a href="#canceling-an-ongoing-authentication-process" class="auto internal xref">Section 9</a>.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deferred-client-notification-endpoint">
<section id="section-7">
      <h2 id="name-deferred-client-notificatio">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-deferred-client-notificatio" class="section-name selfRef">Deferred Client Notification Endpoint</a>
      </h2>
<p id="section-7-1">Since the Deferred Token Response provides a way to authenticate the End‑User asynchronously after User interaction has ended, the Client needs a mechanism to receive this response.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The simplest approach is for the Client to poll the Token Endpoint. In addition, this specification defines a method for the OP to notify the RP when an Authentication decision has been made by sending a Ping Callback to an RP‑defined endpoint.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">This mechanism is RECOMMENDED for both OPs and RPs, as it offers a more efficient way to receive the Authentication decision without relying solely on continuous polling. See <a href="#design-considerations-for-poll-and-ping" class="auto internal xref">Section 14.3</a> for related design considerations.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">The Deferred Client Notification Endpoint operates similarly to the callback modes defined in <span>[<a href="#OpenID.CIBA" class="cite xref">OpenID.CIBA</a>]</span>. Although some parameters behave in comparable ways, they are defined separately to allow an RP supporting both specifications to route and process responses on distinct endpoints, thereby avoiding potential conflicts.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">The specific behavior of the Deferred Client Notification Endpoint is described in <a href="#ping-callback" class="auto internal xref">Section 8.4</a>.<a href="#section-7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="getting-the-authentication-result">
<section id="section-8">
      <h2 id="name-getting-the-authentication-">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-getting-the-authentication-" class="section-name selfRef">Getting the Authentication Result</a>
      </h2>
<p id="section-8-1">Once the <code>deferred_auth_id</code> is obtained, the Relying Party (RP) can retrieve the result of the Authentication Process through interactions with the OpenID Provider (OP). This section describes the mechanisms by which the RP may obtain the authentication result, including RP‑initiated polling and optional Ping Callbacks sent by the OP.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Detailed information about the specific request and response formats, validation steps, and security considerations can be found in the respective subsections.<a href="#section-8-2" class="pilcrow">¶</a></p>
<div id="token-request-using-the-authentication-request-id">
<section id="section-8.1">
        <h3 id="name-token-request-using-the-aut">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-token-request-using-the-aut" class="section-name selfRef">Token Request using the Authentication Request ID</a>
        </h3>
<p id="section-8.1-1">The Client makes an HTTP POST request to the Token Endpoint by sending the following parameters using the <code>application/x-www-form-urlencoded</code> format:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-8.1-2">
          <dt id="section-8.1-2.1"><code>grant_type</code></dt>
          <dd style="margin-left: 1.5em" id="section-8.1-2.2">REQUIRED. Value MUST be <code>urn:openid:params:grant-type:deferred</code>.<a href="#section-8.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-2.3"><code>deferred_auth_id</code></dt>
          <dd style="margin-left: 1.5em" id="section-8.1-2.4">REQUIRED. The unique identifier of the Authentication Process, issued by the OP to the Client requesting the token.<a href="#section-8.1-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-8.1-3">The RP MUST present a DPoP proof in this request if the <a href="#deferred-code-exchange-request">Deferred Code Exchange Request</a> included one. If the RP's Client is a Public Client, the DPoP proof MUST use the same public key used in the Deferred Code Exchange Request. Public keys SHOULD NOT be reused across different Authentication Processes.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">The following is a non-normative example of a deferred token request:<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-5">
<pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
DPoP: eyJ0eXAiOiJkcG9wK2p3dCIsImFsZyI6IkVTMjU2IiwiandrIjp7Imt0eSI6IkVDIiwieCI6Imw4dEZyaHgtMzR0VjNoUklDUkRZOXpDa0RscEJoRjQyVVFVZldWQVdCRnMiLCJ5IjoiOVZFNGpmX09rX282NHpiVFRsY3VOSmFqSG10NnY5VERWclUwQ2R2R1JEQSIsImNydiI6IlAtMjU2In19.eyJqdGkiOiJwS2piNGFEZjEiLCJodG0iOiJQT1NUIiwiaHR1IjoiaHR0cHM6Ly9zZXJ2ZXIuZXhhbXBsZS5jb20vdG9rZW4iLCJpYXQiOjE3NjM3MjMyMjB9.4dr1uoyy8m1giIcVgfsXmO_WISirgOAJxqJZul58QCu_MdxOBZ76HNO70BNyF8NJdv8HACS54etcvBr6C2iXxg

grant_type=urn:openid:params:grant-type:deferred&amp;deferred_auth_id=f4oirNBUlM
</pre><a href="#section-8.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-request-validation">
<section id="section-8.2">
        <h3 id="name-token-request-validation">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-token-request-validation" class="section-name selfRef">Token Request Validation</a>
        </h3>
<p id="section-8.2-1">The OP MUST validate the request received as follows:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-8.2-2">
<li id="section-8.2-2.1">Authenticate the Client in accordance with Section 9 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-8.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-8.2-2.2">Ensure the given <code>deferred_auth_id</code> was issued to the authenticated Client.<a href="#section-8.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-8.2-2.3">If <code>expires_in</code> was provided in <a href="#successful-deferred-code-exchange-response" class="auto internal xref">Section 5.3</a>, verify that the expiration time has not elapsed.<a href="#section-8.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-8.2-2.4">
            <p id="section-8.2-2.4.1">If a DPoP proof was provided in the <a href="#deferred-code-exchange-request">Deferred Code Exchange Request</a><a href="#section-8.2-2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-8.2-2.4.2">
<li id="section-8.2-2.4.2.1">Validate that a DPoP proof is provided in this request.<a href="#section-8.2-2.4.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-8.2-2.4.2.2">If the Client is a Public Client, verify that the public key used in this DPoP proof matches the one used in the Deferred Code Exchange Request.<a href="#section-8.2-2.4.2.2" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-8.2-2.5">If a DPoP proof is provided in this request, validate it in accordance with <span><a href="https://rfc-editor.org/rfc/rfc9449#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>.<a href="#section-8.2-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-8.2-2.6">Verify that the Authentication Process has been completed, has not been canceled and has not reached timeout<a href="#section-8.2-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-8.2-2.7">Verify that no access token has been previously issued for the Deferred Authentication ID.<a href="#section-8.2-2.7" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-8.2-3">If the OP encounters any error, it MUST return an error response, per <a href="#token-request-error-response" class="auto internal xref">Section 10</a>.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="successful-token-response">
<section id="section-8.3">
        <h3 id="name-successful-token-response">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-successful-token-response" class="section-name selfRef">Successful Token Response</a>
        </h3>
<p id="section-8.3-1">After receiving and validating an authorized Token Request from the Client, and once the End User associated with the supplied <code>deferred_auth_id</code> has been authenticated, the OpenID Provider returns a successful response as defined in Section 3.1.3.3 of [OpenID.Core].
After it has been redeemed for a successful Token response, the used <code>deferred_auth_id</code> value becomes invalid.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">The following is a non-normative example of a successful token response:<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-3">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token": "SlAV32hkKG",
  "token_type": "DPoP",
  "expires_in": 3600,
  "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjI3MTdmMzAzYTI3NjVlOGFjYmY0MTEwMGFhOGE0NjllIiwidHlwIjoiSldUIn0.eyJpc3MiOiJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwic3ViIjoiMjQ4Mjg5NzYxMDAxIiwiZW1haWwiOiJqb2huZG9lQGV4YW1wbGUuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF1ZCI6InM2QmhkUmtxdDMiLCJuYW1lIjoiSm9obkRvZSIsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiZXhwIjoxNzYyMTkyNTg4LCJpYXQiOjE3NjIxOTI5ODh9.V0hhdCBkb2VzIG15IHNob2VsIHNheT8gWW91IHNob3VsZCBub3Qgc2hvdw",
  "refresh_token": "8xLOxBtZp8"
}
</pre><a href="#section-8.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ping-callback">
<section id="section-8.4">
        <h3 id="name-ping-callback">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-ping-callback" class="section-name selfRef">Ping Callback</a>
        </h3>
<p id="section-8.4-1">If the client has registered a <code>deferred_client_notification_endpoint</code> during client registration, the OP sends a Ping Callback to that endpoint once the Authentication Process has finished, regardless of the outcome.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">The OP MUST ensure that a successful Deferred Code Exchange Response <a href="#successful-deferred-code-exchange-response" class="auto internal xref">Section 5.3</a> containing the <code>deferred_auth_id</code> was sent to the RP before sending the Ping Callback.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">Ping callbacks are not sent for timed-out Authentication Processes, since the RP is informed of any expiration time via the <code>expires_in</code> parameter in the successful Deferred Code Exchange Response <a href="#successful-deferred-code-exchange-response" class="auto internal xref">Section 5.3</a>.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
<p id="section-8.4-4">The Ping Callback is an HTTP POST request containing the following parameter using the <code>application/json</code> format:<a href="#section-8.4-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-8.4-5">
          <dt id="section-8.4-5.1"><code>deferred_auth_id</code></dt>
          <dd style="margin-left: 1.5em" id="section-8.4-5.2">REQUIRED: The unique identifier of the finished Authentication Process.<a href="#section-8.4-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-8.4-6">The Client MUST protect the Deferred Client Notification Endpoint from unauthorized access.<a href="#section-8.4-6" class="pilcrow">¶</a></p>
<p id="section-8.4-7">If the Client sent a <code>deferred_notification_token</code> in the Deferred Code Exchange Request, the OP MUST send the <code>deferred_notification_token</code> in the <code>Authorization</code> header as a Bearer token in order to authenticate the request.
The Client SHOULD associate the <code>deferred_notification_token</code> with the <code>deferred_auth_id</code> in order to strengthen validation.<a href="#section-8.4-7" class="pilcrow">¶</a></p>
<p id="section-8.4-8">The following is a non-normative example of a Ping callback sent as an HTTP POST request to the Deferred Client Notification Endpoint (with line wraps within values for display purposes only).<a href="#section-8.4-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4-9">
<pre>POST /cb HTTP/1.1
Host: client.example.com
Authorization: Bearer 8d67dc78-7faa-4d41-aabd-67707b374255
Content-Type: application/json

{
  "deferred_auth_id": "f4oirNBUlM"
}
</pre><a href="#section-8.4-9" class="pilcrow">¶</a>
</div>
<p id="section-8.4-10">The Client MUST verify the <code>deferred_notification_token</code> to authenticate the request if it is present.
If the bearer token is invalid, the RP SHOULD respond with an HTTP 401 Unauthorized status code.<a href="#section-8.4-10" class="pilcrow">¶</a></p>
<p id="section-8.4-11">For valid requests, the Deferred Client Notification Endpoint SHOULD respond with an HTTP 204 No Content status code.
The OP SHOULD also accept responses with HTTP 200 OK, and any HTTP body in the response SHOULD be ignored.<a href="#section-8.4-11" class="pilcrow">¶</a></p>
<p id="section-8.4-12">The Client MUST NOT return an HTTP 3xx status code. The OP MUST NOT follow redirects.<a href="#section-8.4-12" class="pilcrow">¶</a></p>
<p id="section-8.4-13">Handling of HTTP error codes in the 4xx and 5xx ranges by the OP is out of scope for this specification. Administrative action is likely to be required in these cases.<a href="#section-8.4-13" class="pilcrow">¶</a></p>
<p id="section-8.4-14">Clients MUST ignore unrecognized request parameters.<a href="#section-8.4-14" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="canceling-an-ongoing-authentication-process">
<section id="section-9">
      <h2 id="name-canceling-an-ongoing-authen">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-canceling-an-ongoing-authen" class="section-name selfRef">Canceling an Ongoing Authentication Process</a>
      </h2>
<p id="section-9-1">In some scenarios, the RP might need to cancel an ongoing Authentication Process that was deferred before completion (e.g. user-initiated cancellation) to avoid unnecessary processing for both the RP and the OP. This specification defines the Cancellation Endpoint that the RP can use to cancel an ongoing Authentication Process.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The Authentication Cancellation can be achieved by the RP sending a request to the OP as described in the following sections.<a href="#section-9-2" class="pilcrow">¶</a></p>
<div id="authentication-cancellation-request">
<section id="section-9.1">
        <h3 id="name-authentication-cancellation">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-authentication-cancellation" class="section-name selfRef">Authentication Cancellation Request</a>
        </h3>
<p id="section-9.1-1">Once the RP gets possession of the <code>deferred_auth_id</code> from the Deferred Code Exchange Response, it can send an Authentication Cancellation Request to the OP in order to cancel the ongoing Authentication Process.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">The Client makes an HTTP POST request to the Authentication Cancellation Endpoint by sending the following parameters using the <code>application/x-www-form-urlencoded</code> format:<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.1-3">
          <dt id="section-9.1-3.1"><code>deferred_auth_id</code></dt>
          <dd style="margin-left: 1.5em" id="section-9.1-3.2">REQUIRED. The unique identifier of the Authentication Process, issued by the OP to the Client requesting the cancellation.<a href="#section-9.1-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-9.1-4">The RP MUST present a DPoP proof in this request if the <a href="#deferred-code-exchange-request">Deferred Code Exchange Request</a> included one. If the RP's Client is a Public Client, the DPoP proof MUST use the same public key used in the Deferred Code Exchange Request. Public keys SHOULD NOT be reused across different Authentication Processes.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">The following is a non-normative example of an authentication cancellation request:<a href="#section-9.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1-6">
<pre>POST /df-authentication/cancel HTTP/1.1
Host: server.example.com
Content-Type: application/json
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
DPoP: eyJ0eXAiOiJkcG9wK2p3dCIsImFsZyI6IlJTMjU2IiwiandrIjp7Imt0eSI6IkVDIiwieCI6Imw4dEZyaHgtMzR0VjNoUklDUkRZOXpDa0RscEJoRjQyVVFVZldWQVdCRnMiLCJ5IjoiOVZFNGpmX09rX282NHpiVFRsY3VOSmFqSG10NnY5VERWclUwQ2R2R1JEQSIsImNydiI6IlAtMjU2In19.eyJqdGkiOiJwS2piNGFEZjEiLCJodG0iOiJQT1NUIiwiaHR1IjoiaHR0cHM6Ly9zZXJ2ZXIuZXhhbXBsZS5jb20vZGYtYXV0aGVudGljYXRpb24vY2FuY2VsIiwiaWF0IjoxNzYzNzIzMTkwfQ.Ux89nsFXQLRKJxW5OZrOTSSQWtRAZsfB5542hICkOoOBQIOZua5US4sX7JLUqklykKSCHKeWB1FFZF4PJCmTikY9-RQPKh_rQlGFXUjnUUuAi_zatJPMh3e94EdHzHXIkUpNHV6HOTQfJZntM-eRZMGLBoFGKEiHpJlWSLWtV6pRV4GIvE8FgimNP111G_8ZSfty6K-gmIUlDZHl7LHo1GotiRuGyQOxiyqEPqV35unZiskdyIsisnA2O7nXViAD9ARuGAuM-eFlE6QJ1ji4aAPAUJnPLA0mbRhsP2DYU8YDee9tAbAkl9e45l9zhLsdEbQT07yv8zMb7zuRuczQZQ

{
  "deferred_auth_id": "SplxlOBeZQQYbYS6WxSbIA"
}
</pre><a href="#section-9.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authentication-cancellation-request-validation">
<section id="section-9.2">
        <h3 id="name-authentication-cancellation-">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-authentication-cancellation-" class="section-name selfRef">Authentication Cancellation Request Validation</a>
        </h3>
<p id="section-9.2-1">The OP MUST validate the request received as follows:<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-9.2-2">
<li id="section-9.2-2.1">Authenticate the Client in accordance with Section 9 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-9.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-9.2-2.2">Ensure the given <code>deferred_auth_id</code> was issued to the authenticated Client.<a href="#section-9.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-9.2-2.3">
            <p id="section-9.2-2.3.1">If a DPoP proof was provided in the <a href="#deferred-code-exchange-request">Deferred Code Exchange Request</a><a href="#section-9.2-2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-9.2-2.3.2">
<li id="section-9.2-2.3.2.1">Validate that a DPoP proof is provided in this request.<a href="#section-9.2-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-9.2-2.3.2.2">If the Client is a Public Client, verify that the public key used in this DPoP proof matches the one used in the Deferred Code Exchange Request.<a href="#section-9.2-2.3.2.2" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-9.2-2.4">If a DPoP proof is provided in this request, validate it in accordance with <span><a href="https://rfc-editor.org/rfc/rfc9449#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>.<a href="#section-9.2-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-9.2-2.5">Verify that no access token has been previously issued for the Deferred Authentication.<a href="#section-9.2-2.5" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-9.2-3">After successful validation, the OP marks this Authentication Request as cancelled. Any requests to poll for the result of the Authentication Process after the OP accepts the cancellation request MUST be handled as described in <a href="#token-request-error-response" class="auto internal xref">Section 10</a>.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">Disposal of any collected Identity Information is beyond the scope of this specification.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-cancellation-response">
<section id="section-9.3">
        <h3 id="name-authentication-cancellation-r">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-authentication-cancellation-r" class="section-name selfRef">Authentication Cancellation Response</a>
        </h3>
<p id="section-9.3-1">The OP responds to the Authentication Cancellation Request with an HTTP 200 status code if the cancellation was successful, or if the RP submitted an invalid or already-processed <code>deferred_auth_id</code>.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">Since the purpose of this request is to stop the Authentication Process, distinction of the cancellation outcome is not necessary for the RP.
This behavior is similar to <span><a href="https://rfc-editor.org/rfc/rfc7009#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC7009" class="cite xref">RFC7009</a>]</span>.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<p id="section-9.3-3">The following is a non-normative example of an authentication cancellation response:<a href="#section-9.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.3-4">
<pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store
</pre><a href="#section-9.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="token-request-error-response">
<section id="section-10">
      <h2 id="name-token-request-error-respons">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-token-request-error-respons" class="section-name selfRef">Token Request Error Response</a>
      </h2>
<p id="section-10-1">If the Token Request is invalid or unauthorized, or if the Authentication Process has not yet completed, the OpenID Provider returns an error response as described in section 3.1.3.4 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">In Addition to the error codes defined in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, this specification uses error codes defined in <span><a href="https://rfc-editor.org/rfc/rfc8628#section-3.5" class="relref">Section 3.5</a> of [<a href="#RFC8628" class="cite xref">RFC8628</a>]</span>, <span><a href="https://rfc-editor.org/rfc/rfc9449#section-5" class="relref">Section 5</a> of [<a href="#RFC9449" class="cite xref">RFC9449</a>]</span> and section 11 of <span>[<a href="#OpenID.CIBA" class="cite xref">OpenID.CIBA</a>]</span>:<a href="#section-10-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10-3">
        <dt id="section-10-3.1"><code>authorization_pending</code></dt>
        <dd style="margin-left: 1.5em" id="section-10-3.2">The Authentication is being processed and has not yet completed.<a href="#section-10-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.3"><code>slow_down</code></dt>
        <dd style="margin-left: 1.5em" id="section-10-3.4">The Client is polling too quickly and MUST slow down the rate of requests. The interval between requests MUST be increased by at least 5 seconds.<a href="#section-10-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.5"><code>expired_token</code></dt>
        <dd style="margin-left: 1.5em" id="section-10-3.6">The <code>deferred_auth_id</code> has expired. The Client MUST stop polling with this <code>deferred_auth_id</code> and MAY restart the Authentication Process.<a href="#section-10-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.7"><code>access_denied</code></dt>
        <dd style="margin-left: 1.5em" id="section-10-3.8">The Identity Information couldn't be attested according to the requirements of the Authentication Request, or the Authentication Process was cancelled.<a href="#section-10-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.9"><code>invalid_dpop_proof</code></dt>
        <dd style="margin-left: 1.5em" id="section-10-3.10">The DPoP proof is missing, invalid, or does not match the requirements of <a href="#token-request-using-the-authentication-request-id" class="auto internal xref">Section 8.1</a>.<a href="#section-10-3.10" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-10-4">The following behaviors apply to the error responses:<a href="#section-10-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-5.1">
          <p id="section-10-5.1.1">If the <code>deferred_auth_id</code> is invalid or was issued to another Client, an <code>invalid_grant</code> error MUST be returned as defined in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-10-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-5.2">
          <p id="section-10-5.2.1">If a Client continually polls faster than the <code>interval</code> parameter of the Deferred Code Exchange Response, the OP MAY respond with an <code>invalid_request</code> error.<a href="#section-10-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-5.3">
          <p id="section-10-5.3.1">If a Client receives an <code>invalid_request</code> error, it MUST not make any further requests for the same <code>deferred_auth_id</code>.<a href="#section-10-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-10-6">The error response MUST be encoded in <code>application/json</code> media type with the following parameters:<a href="#section-10-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10-7">
        <dt id="section-10-7.1"><code>error</code></dt>
        <dd style="margin-left: 1.5em" id="section-10-7.2">REQUIRED. A single ASCII error code as described above.<a href="#section-10-7.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-7.3"><code>error_description</code></dt>
        <dd style="margin-left: 1.5em" id="section-10-7.4">OPTIONAL. Human-readable ASCII [USASCII] text to assist the client developer.<a href="#section-10-7.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-7.5"><code>error_uri</code></dt>
        <dd style="margin-left: 1.5em" id="section-10-7.6">OPTIONAL. A URI of a web page with information about the error to provide the client developer with additional information.<a href="#section-10-7.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-10-8">The following is a non-normative example of a Token Request Error Response:<a href="#section-10-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10-9">
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
  "error": "authorization_pending",
  "error_description": "The authentication is still being processed."
}
</pre><a href="#section-10-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="deferred-code-exchange-error-response">
<section id="section-11">
      <h2 id="name-deferred-code-exchange-erro">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-deferred-code-exchange-erro" class="section-name selfRef">Deferred Code Exchange Error Response</a>
      </h2>
<p id="section-11-1">If the Deferred Code Exchange Request is invalid or unauthorized, the OpenID Provider constructs an error response as described in section 3.1.3.4 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>. The Deferred Code Exchange extends the definition of the following error code:<a href="#section-11-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-11-2">
        <dt id="section-11-2.1"><code>invalid_grant</code></dt>
        <dd style="margin-left: 1.5em" id="section-11-2.2">The <code>deferred_code</code> is invalid, expired, or was issued to another Client.<a href="#section-11-2.2" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-11-3">When using DPoP <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>, the following error code is also applicable:<a href="#section-11-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-11-4">
        <dt id="section-11-4.1"><code>invalid_dpop_proof</code></dt>
        <dd style="margin-left: 1.5em" id="section-11-4.2">The DPoP proof is missing, invalid, or does not match the requirements of <a href="#deferred-code-exchange-request" class="auto internal xref">Section 5.1</a>.<a href="#section-11-4.2" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-11-5">The error response parameters MUST be encoded in <code>application/json</code> media type with the following parameters:<a href="#section-11-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-11-6">
        <dt id="section-11-6.1"><code>error</code></dt>
        <dd style="margin-left: 1.5em" id="section-11-6.2">REQUIRED. Error code.<a href="#section-11-6.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-11-6.3"><code>error_description</code></dt>
        <dd style="margin-left: 1.5em" id="section-11-6.4">OPTIONAL. Human-readable ASCII encoded text description of the error.<a href="#section-11-6.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-11-6.5"><code>error_uri</code></dt>
        <dd style="margin-left: 1.5em" id="section-11-6.6">OPTIONAL. URI of a web page that includes additional information about the error.<a href="#section-11-6.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-11-7">The following is a non-normative example of a Deferred Code Exchange Error Response:<a href="#section-11-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11-8">
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
  "error": "invalid_grant",
  "error_description": "The request grant is invalid, expired, or was issued to another client."
}
</pre><a href="#section-11-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authentication-request-error-response">
<section id="section-12">
      <h2 id="name-authentication-request-erro">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-authentication-request-erro" class="section-name selfRef">Authentication Request Error Response</a>
      </h2>
<p id="section-12-1">When an Authentication Request is invalid, or the End-User cancels or fails to provide Identity Information, the OpenID Provider creates an Authentication Error Response.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">This error response means that no further processing will be performed for the corresponding Authentication Request. The OP MUST return the error response in accordance with section 3.1.2.6 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">The error response parameters are the following:<a href="#section-12-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-12-4">
        <dt id="section-12-4.1"><code>error</code></dt>
        <dd style="margin-left: 1.5em" id="section-12-4.2">REQUIRED. Error code.<a href="#section-12-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-12-4.3"><code>error_description</code></dt>
        <dd style="margin-left: 1.5em" id="section-12-4.4">OPTIONAL. Human-readable ASCII encoded text description of the error.<a href="#section-12-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-12-4.5"><code>error_uri</code></dt>
        <dd style="margin-left: 1.5em" id="section-12-4.6">OPTIONAL. URI of a web page that includes additional information about the error.<a href="#section-12-4.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-12-4.7"><code>state</code></dt>
        <dd style="margin-left: 1.5em" id="section-12-4.8">OAuth 2.0 state value. REQUIRED if the Authorization Request included the state parameter. Set to the value received from the Client.<a href="#section-12-4.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-12-5">Response error parameters MUST be encoded in accordance to the <code>response_mode</code> used in the original <a href="#authentication-request">Authentication Request</a>. See <span>[<a href="#OAuth.Responses" class="cite xref">OAuth.Responses</a>]</span> and <span>[<a href="#OAuth.Post" class="cite xref">OAuth.Post</a>]</span> for examples.<a href="#section-12-5" class="pilcrow">¶</a></p>
<p id="section-12-6">The following is a non-normative example of an Authentication Request Error Response:<a href="#section-12-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12-7">
<pre>HTTP/1.1 302 Found
  Location: https://client.example.org/cb?
    error=unauthorized_client
    &amp;error_description=
      Client%20is%20not%20authorized%20to%20use%20deferred_code%20response%20type
    &amp;state=af0ifjsldkj
</pre><a href="#section-12-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authentication-cancellation-request-error-response">
<section id="section-13">
      <h2 id="name-authentication-cancellation-re">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-authentication-cancellation-re" class="section-name selfRef">Authentication Cancellation Request Error Response</a>
      </h2>
<p id="section-13-1">When an invalid Authentication Cancellation Request is received, the OpenID Provider returns an error response that contains one of the following error codes:<a href="#section-13-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-13-2">
        <dt id="section-13-2.1"><code>invalid_request</code></dt>
        <dd style="margin-left: 1.5em" id="section-13-2.2">The request is missing a required parameter, or is otherwise malformed.<a href="#section-13-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-2.3"><code>invalid_client</code></dt>
        <dd style="margin-left: 1.5em" id="section-13-2.4">Client authentication failed (e.g. invalid client credentials, unknown client, no client authentication included, or unsupported authentication method). The authorization server MAY return an HTTP 401 (Unauthorized) status code to indicate which HTTP authentication schemes are supported. If the client attempted to authenticate via the "Authorization" request header field, the authorization server MUST respond with an HTTP 401 (Unauthorized) status code and include the "WWW-Authenticate" response header field matching the authentication scheme used by the client.<a href="#section-13-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-2.5"><code>unauthorized_client</code></dt>
        <dd style="margin-left: 1.5em" id="section-13-2.6">The authenticated client is not authorized to use the Deferred Code Grant Type.<a href="#section-13-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-2.7"><code>invalid_dpop_proof</code></dt>
        <dd style="margin-left: 1.5em" id="section-13-2.8">The DPoP proof is missing, invalid, or does not match the requirements of <a href="#authentication-cancellation-request">Authentication Cancellation Request</a>.<a href="#section-13-2.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-13-3">The error response MUST use the 400 status code unless explicitly specified otherwise, and parameters MUST be encoded in <code>application/json</code> media type:<a href="#section-13-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-13-4">
        <dt id="section-13-4.1"><code>error</code></dt>
        <dd style="margin-left: 1.5em" id="section-13-4.2">REQUIRED. A single ASCII error code as described above.<a href="#section-13-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-4.3"><code>error_description</code></dt>
        <dd style="margin-left: 1.5em" id="section-13-4.4">OPTIONAL. Human-readable ASCII [USASCII] text to assist the client developer.<a href="#section-13-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-4.5"><code>error_uri</code></dt>
        <dd style="margin-left: 1.5em" id="section-13-4.6">OPTIONAL. A URI of a web page with information about the error to provide the client developer with additional information.<a href="#section-13-4.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-13-5">The following is a non-normative example of a Deferred Code Exchange Error Response:<a href="#section-13-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13-6">
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
  "error": "unauthorized_client",
  "error_description": "The client is not authorized to use the Deferred Code Grant Type."
}
</pre><a href="#section-13-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="implementation-considerations">
<section id="section-14">
      <h2 id="name-implementation-consideratio">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<div id="interim-id-tokens">
<section id="section-14.1">
        <h3 id="name-interim-id-tokens">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-interim-id-tokens" class="section-name selfRef">Interim ID Tokens</a>
        </h3>
<p id="section-14.1-1">The Interim ID Token MAY contain both validated and unvalidated claims about the End User.
The scheme used to distinguish validated claims from unvalidated claims is outside the scope of this specification.
Options include:
1. Using the <code>verified_claims</code> from <span>[<a href="#OpenID4IDA" class="cite xref">OpenID4IDA</a>]</span>.
2. Coordination between each Client and OP to define claim names.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multi-valued-response-type-authentication-request">
<section id="section-14.2">
        <h3 id="name-multi-valued-response-type-">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-multi-valued-response-type-" class="section-name selfRef">Multi-valued Response Type Authentication Request</a>
        </h3>
<p id="section-14.2-1">The OP MAY accept Authentication Requests providing the response type value as <code>deferred_code code</code>. In those cases, it means for the OP that it MAY chose, by its own means, when the Authentication response will be of deferred type or any other provided alternative.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="design-considerations-for-poll-and-ping">
<section id="section-14.3">
        <h3 id="name-design-considerations-for-p">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-design-considerations-for-p" class="section-name selfRef">Design Considerations for Poll and Ping</a>
        </h3>
<p id="section-14.3-1">The Ping Callback enables long-running Authentication Processes to occur without wasting network resources on a large amount of Poll requests. Given the asynchronous nature of the interactions introduced by Deferred Token Response, some design considerations are outlined below.<a href="#section-14.3-1" class="pilcrow">¶</a></p>
<p id="section-14.3-2">In case an OpenID Provider returns an <code>authorization_pending</code> Token Request Error Response after sending a Ping Callback, the Relying Party SHOULD keep sending Token Requests.
This improves the success rates in distributed systems that may incorrectly send Ping Callbacks too early and prevents denial-of-service attacks in case the Deferred Client Notification Endpoint is compromised.<a href="#section-14.3-2" class="pilcrow">¶</a></p>
<p id="section-14.3-3">In certain scenarios, an RP awaiting an Authentication Process that is close to expiring may choose to perform one final Token Request slightly before the required polling interval, as close as possible to the process’s expiration time. This RP‑side strategy can help mitigate the impact of missed Ping Callbacks or authentication decisions made too late to fall within the normal polling schedule.<a href="#section-14.3-3" class="pilcrow">¶</a></p>
<p id="section-14.3-4">This specification intentionally does not define a way to deliver the token directly to the Client Notification Endpoint, known as <em>push mode</em> in CIBA. The <em>push mode</em> is not appropriate for long-running high-value Authentication Processes since losing the single push request would mean losing the outcome of the entire Authentication Process.<a href="#section-14.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="context-on-the-progress-of-incomplete-authentication-processes">
<section id="section-14.4">
        <h3 id="name-context-on-the-progress-of-">
<a href="#section-14.4" class="section-number selfRef">14.4. </a><a href="#name-context-on-the-progress-of-" class="section-name selfRef">Context on the Progress of Incomplete Authentication Processes</a>
        </h3>
<p id="section-14.4-1">OpenID Providers SHOULD include appropriate context regarding the progress of the Authentication Process when responding with a Token Request Error Response because the Authentication Process has not yet been completed.
Such context SHOULD be included in the <code>error_description</code> field of the Token Request Error Response.<a href="#section-14.4-1" class="pilcrow">¶</a></p>
<p id="section-14.4-2">Appropriate context regarding the progress depends on the use case and the nature of the Authentication Process and the Identity Information.
The Relying Party MAY forward the context to the End User if appropriate.<a href="#section-14.4-2" class="pilcrow">¶</a></p>
<p id="section-14.4-3">Examples of appropriate context regarding the progress of the Authentication Process include:
1. If the Authentication Process includes multiple steps, the step currently being performed.
2. If the OpenID Provider uses a queue system to schedule Authentication Process work, the number of Authentication Processes queued before the current one.
3. An estimate of the remaining processing time, if available.<a href="#section-14.4-3" class="pilcrow">¶</a></p>
<p id="section-14.4-4">The OpenID Provider MAY communicate the progress of each Authentication Process to the Relying Party in other ways.
Mechanisms for doing so are outside the scope of this specification.<a href="#section-14.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-15">
      <h2 id="name-privacy-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
    </h2>
</section>
</div>
<div id="security-considerations">
<section id="section-16">
      <h2 id="name-security-considerations">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-16-1">In addition to the security considerations described in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>, <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>, and <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>, the following considerations apply to this specification.<a href="#section-16-1" class="pilcrow">¶</a></p>
<div id="usage-of-deferred-notification-tokens">
<section id="section-16.1">
        <h3 id="name-usage-of-deferred-notificat">
<a href="#section-16.1" class="section-number selfRef">16.1. </a><a href="#name-usage-of-deferred-notificat" class="section-name selfRef">Usage of Deferred Notification Tokens</a>
        </h3>
<p id="section-16.1-1">The <code>deferred_notification_token</code> is a bearer token that enables the OP to authenticate to the RP when sending the Ping Callback. Therefore, it is imperative that this token is protected against unauthorized access and disclosure.<a href="#section-16.1-1" class="pilcrow">¶</a></p>
<p id="section-16.1-2">This token SHOULD be generated following the least privilege principle, ensuring it can only be used for its intended purpose of authenticating the OP to the RP during the Ping Callback.<a href="#section-16.1-2" class="pilcrow">¶</a></p>
<p id="section-16.1-3">If the Client chooses not to use Deferred Notification Tokens to protect the Deferred Notification Endpoint, the Client MUST protect the endpoint in some other way.
One option is to use mutual TLS.<a href="#section-16.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-17">
      <h2 id="name-iana-considerations">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-17-1">No new registrations.<a href="#section-17-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-18">
      <h2 id="name-references">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-18.1">
        <h3 id="name-normative-references">
<a href="#section-18.1" class="section-number selfRef">18.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="OpenID.CIBA">[OpenID.CIBA]</dt>
        <dd>
<span class="refAuthor">Fernandez, G.</span>, <span class="refAuthor">Walter, F.</span>, <span class="refAuthor">Nennker, A.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"OpenID Connect Client-Initiated Backchannel Authentication Flow - Core 1.0"</span>, <time datetime="2021-09-01" class="refDate">1 September 2021</time>, <span>&lt;<a href="https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html">https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Core">[OpenID.Core]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.B.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0 incorporating errata set 2"</span>, <time datetime="2023-12-15" class="refDate">15 December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6819">[RFC6819]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T., Ed.</span>, <span class="refAuthor">McGloin, M.</span>, and <span class="refAuthor">P. Hunt</span>, <span class="refTitle">"OAuth 2.0 Threat Model and Security Considerations"</span>, <span class="seriesInfo">RFC 6819</span>, <span class="seriesInfo">DOI 10.17487/RFC6819</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6819">https://www.rfc-editor.org/info/rfc6819</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7009">[RFC7009]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T., Ed.</span>, <span class="refAuthor">Dronia, S.</span>, and <span class="refAuthor">M. Scurtescu</span>, <span class="refTitle">"OAuth 2.0 Token Revocation"</span>, <span class="seriesInfo">RFC 7009</span>, <span class="seriesInfo">DOI 10.17487/RFC7009</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7009">https://www.rfc-editor.org/info/rfc7009</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7591">[RFC7591]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Machulak, M.</span>, and <span class="refAuthor">P. Hunt</span>, <span class="refTitle">"OAuth 2.0 Dynamic Client Registration Protocol"</span>, <span class="seriesInfo">RFC 7591</span>, <span class="seriesInfo">DOI 10.17487/RFC7591</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7591">https://www.rfc-editor.org/info/rfc7591</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8628">[RFC8628]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"OAuth 2.0 Device Authorization Grant"</span>, <span class="seriesInfo">RFC 8628</span>, <span class="seriesInfo">DOI 10.17487/RFC8628</span>, <time datetime="2019-08" class="refDate">August 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8628">https://www.rfc-editor.org/info/rfc8628</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9449">[RFC9449]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">D. Waite</span>, <span class="refTitle">"OAuth 2.0 Demonstrating Proof of Possession (DPoP)"</span>, <span class="seriesInfo">RFC 9449</span>, <span class="seriesInfo">DOI 10.17487/RFC9449</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9449">https://www.rfc-editor.org/info/rfc9449</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9700">[RFC9700]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Labunets, A.</span>, and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"Best Current Practice for OAuth 2.0 Security"</span>, <span class="seriesInfo">BCP 240</span>, <span class="seriesInfo">RFC 9700</span>, <span class="seriesInfo">DOI 10.17487/RFC9700</span>, <time datetime="2025-01" class="refDate">January 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9700">https://www.rfc-editor.org/info/rfc9700</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-18.2">
        <h3 id="name-informative-references">
<a href="#section-18.2" class="section-number selfRef">18.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="OAuth.Post">[OAuth.Post]</dt>
        <dd>
<span class="refAuthor">Jones, M.B.</span> and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Form Post Response Mode"</span>, <time datetime="2014-02-25" class="refDate">25 February 2014</time>, <span>&lt;<a href="http://openid.net/specs/oauth-v2-form-post-response-mode-1_0.html">http://openid.net/specs/oauth-v2-form-post-response-mode-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OAuth.Responses">[OAuth.Responses]</dt>
        <dd>
<span class="refAuthor">de Medeiros, B., Ed.</span>, <span class="refAuthor">Scurtescu, M.</span>, <span class="refAuthor">Tarjan, P.</span>, and <span class="refAuthor">M.B. Jones</span>, <span class="refTitle">"OAuth 2.0 Multiple Response Type Encoding Practices"</span>, <time datetime="2014-02-25" class="refDate">25 February 2014</time>, <span>&lt;<a href="https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html">https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID4IDA">[OpenID4IDA]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Haine, M.</span>, <span class="refAuthor">Pulido, A.</span>, <span class="refAuthor">Lehmann, K.</span>, and <span class="refAuthor">K. Koiwai</span>, <span class="refTitle">"OpenID Connect for Identity Assurance 1.0"</span>, <time datetime="2024-10-01" class="refDate">1 October 2024</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-4-identity-assurance-1_0.html">https://openid.net/specs/openid-connect-4-identity-assurance-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="use-cases">
<section id="appendix-A">
      <h2 id="name-use-cases">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-use-cases" class="section-name selfRef">Use cases</a>
      </h2>
<div id="sample-use-case-1-high-risk-transaction-evaluation">
<section id="appendix-A.1">
        <h3 id="name-sample-use-case-1-high-risk">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-sample-use-case-1-high-risk" class="section-name selfRef">Sample Use Case 1: High Risk Transaction Evaluation</a>
        </h3>
<p id="appendix-A.1-1">An online banking application requires users to approve a high-risk transaction through a multi-step verification process. It is acceptable for this transaction to take several minutes, up to some hours to complete processing, as it may require additional security checks. It is not necessary for the user to remain actively engaged with the banking application during this time.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">When a user initiates such a transaction, the banking application (RP) sends an Authentication Request with the <code>deferred_code code</code> response type to the bank's OpenID Provider (OP). While interacting with the End-user, the OP notices unusual behavior and decides to defer the Authentication Process until further verification is complete.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">Verifying the legitimacy of the intent for such a transaction may involve contacting the user through alternative channels, performing manual reviews, or other security measures. During this time, the user is free to leave the banking application.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1-4">Transaction processing continues in the background as soon as an Authentication Decision is made.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sample-use-case-2-step-up-identity-assurance-during-a-non-registration-process">
<section id="appendix-A.2">
        <h3 id="name-sample-use-case-2-step-up-i">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-sample-use-case-2-step-up-i" class="section-name selfRef">Sample Use Case 2: Step-up identity assurance during a non-registration process</a>
        </h3>
<p id="appendix-A.2-1">Many banking applications rely on credentials registered in person at a branch office, which involves human verification of identity documents. In many cases, those credentials are Passwords or Banking Code Cards.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">Switching to on-line services, those credentials may not be sufficient to perform high-assurance operations. Applying for a loan or changing contact information may require a higher level of identity assurance, and for such, users should be authenticated using stronger mechanisms to prove their identity.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-3">Concentrating this type of verification at the OP allows the RP to delegate the complexity of identity verification. This also allows changes in policies and identity verification methods without involving the RP.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4">OPs can require the use of Biometric data or documents to perform identity verification that complies to the Assurance Level required by the RP. Since not all data can be verified instantly, the use of deferred authentication allows the OP to take the necessary time to perform identity verification.<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<p id="appendix-A.2-5">The RP requests Authentication with the <code>deferred_code code</code> response type, and in cases where the deferral is necessary, the OP can take the time needed to verify the identity of the user in the background. The RP can then present steps that don't demand the completion of the Authentication Process such as form filling, and notify the user when the final decision is made.<a href="#appendix-A.2-5" class="pilcrow">¶</a></p>
<p id="appendix-A.2-6">This allows for the RP to provide a better user experience, without forcing the user to stay on the RP site, requiring re-authentication, or other disruptive actions.<a href="#appendix-A.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sample-use-case-3-identification-based-on-physical-evidence">
<section id="appendix-A.3">
        <h3 id="name-sample-use-case-3-identific">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-sample-use-case-3-identific" class="section-name selfRef">Sample Use Case 3: Identification Based on Physical Evidence</a>
        </h3>
<p id="appendix-A.3-1">Many jurisdictions do not have a widespread method of digital identity verification such as an electronic ID.
In these jurisdictions, a common way to do identity verification is to scan a physical identity document such as a passport or a driver's license.
The scan is often supplemented with a liveness check consisting of e.g. a video recording of the End User, which is matched with a photograph on the physical identity document.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2">In many cases, automated systems can determine whether the physical identity document is authentic and whether the liveness check matches the photograph.
In some cases, manual verification by a human operator is necessary.
This manual verification can take a long time and may involve contacting the End User via another channel, which means that an ID Token can not immediately be returned.<a href="#appendix-A.3-2" class="pilcrow">¶</a></p>
<p id="appendix-A.3-3">The RP requests Authentication with the <code>deferred_code code</code> response type, and in cases where the deferral is necessary, the OP can manually verify the authenticity of the physical identity document and the match between the liveness check and the photograph.
The RP can then continue with steps that don't demand the completion of the Authentication Process, and notify the user when the final decision is made.<a href="#appendix-A.3-3" class="pilcrow">¶</a></p>
<p id="appendix-A.3-4">This allows the RP to process most identity verification requests immediately while remaining compliant with regulation on automated decision making in identity verification.<a href="#appendix-A.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1"><em>To be completed.</em><a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notices">
<section id="appendix-C">
      <h2 id="name-notices">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-notices" class="section-name selfRef">Notices</a>
      </h2>
<p id="appendix-C-1"><em>To be completed.</em><a href="#appendix-C-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-D">
      <h2 id="name-document-history">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-D-1">[[ To be removed from the final specification ]]<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-D-2.1">00
Initial draft.<a href="#appendix-D-2.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Frederik Krogsdal Jacobsen</span></div>
<div dir="auto" class="left"><span class="org">Idura</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:frederik.krogsdal@idura.eu" class="email">frederik.krogsdal@idura.eu</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Guilherme de Oliveira Niero</span></div>
<div dir="auto" class="left"><span class="org">Independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:iam@gniero.com" class="email">iam@gniero.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
